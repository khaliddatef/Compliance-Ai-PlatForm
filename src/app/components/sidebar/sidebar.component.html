<nav class="sidebar" [class.open]="open" [class.collapsed]="!open" aria-label="Primary">
  <div class="sidebar-top">
    <div class="brand">
      <div class="brand-switch">
        <span class="logo-mark" aria-hidden="true">
          <svg viewBox="0 0 24 24" focusable="false">
            <path
              d="M12 3.5 5 6v6.5c0 3.4 2.5 6.6 7 8.5 4.5-1.9 7-5.1 7-8.5V6l-7-2.5Z"
              fill="none"
              stroke="currentColor"
              stroke-width="1.6"
              stroke-linejoin="round"
            />
            <path
              d="M9.5 12.5 11 14l3.5-3.5"
              fill="none"
              stroke="currentColor"
              stroke-width="1.6"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </span>
        <button
          class="menu-mark"
          type="button"
          (click)="toggleSidebar.emit()"
          aria-label="Toggle sidebar"
        >
          <span class="bar"></span>
          <span class="bar"></span>
          <span class="bar"></span>
        </button>
      </div>
      <div class="brand-text">
        <span class="brand-title">Tekronyx</span>
        <span class="brand-sub">Compliance AI</span>
      </div>
    </div>

    <div class="nav">
      <a
        *ngFor="let item of navItems"
        class="nav-item"
        [routerLink]="item.path"
        routerLinkActive="active"
        [routerLinkActiveOptions]="{ exact: true }"
        (click)="handleNavClick(item, $event)"
      >
        <span class="nav-icon" aria-hidden="true" [ngSwitch]="item.icon">
          <svg *ngSwitchCase="'home'" viewBox="0 0 24 24" focusable="false">
            <path d="M4 11.5L12 5l8 6.5" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M6 10.5V19h12v-8.5" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <svg *ngSwitchCase="'history'" viewBox="0 0 24 24" focusable="false">
            <circle cx="12" cy="12" r="8.5" fill="none" stroke="currentColor" stroke-width="1.6"/>
            <path d="M12 7.5v5l3 2" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <svg *ngSwitchCase="'dashboard'" viewBox="0 0 24 24" focusable="false">
            <rect x="3" y="3" width="8" height="8" rx="2" fill="none" stroke="currentColor" stroke-width="1.6"/>
            <rect x="13" y="3" width="8" height="5" rx="2" fill="none" stroke="currentColor" stroke-width="1.6"/>
            <rect x="13" y="10" width="8" height="11" rx="2" fill="none" stroke="currentColor" stroke-width="1.6"/>
            <rect x="3" y="13" width="8" height="8" rx="2" fill="none" stroke="currentColor" stroke-width="1.6"/>
          </svg>
          <svg *ngSwitchCase="'uploads'" viewBox="0 0 24 24" focusable="false">
            <path d="M4 17v2a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1v-2" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
            <path d="M12 4v9" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
            <path d="M8.5 7.5L12 4l3.5 3.5" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <svg *ngSwitchCase="'frameworks'" viewBox="0 0 24 24" focusable="false">
            <rect x="4" y="4" width="10" height="10" rx="2" fill="none" stroke="currentColor" stroke-width="1.6"/>
            <rect x="10" y="10" width="10" height="10" rx="2" fill="none" stroke="currentColor" stroke-width="1.6"/>
          </svg>
          <svg *ngSwitchCase="'settings'" viewBox="0 0 24 24" focusable="false">
            <circle cx="12" cy="12" r="3" fill="none" stroke="currentColor" stroke-width="1.6"/>
            <path
              d="M19.4 12a7.4 7.4 0 0 0 .05-.9l2.1-1.6-2-3.5-2.5 1a7.3 7.3 0 0 0-1.5-.9L15 3h-6l-.55 2.1a7.3 7.3 0 0 0-1.5.9l-2.5-1-2 3.5 2.1 1.6a7.4 7.4 0 0 0 0 1.8l-2.1 1.6 2 3.5 2.5-1a7.3 7.3 0 0 0 1.5.9L9 21h6l.55-2.1a7.3 7.3 0 0 0 1.5-.9l2.5 1 2-3.5-2.1-1.6c.03-.3.05-.6.05-.9Z"
              fill="none"
              stroke="currentColor"
              stroke-width="1.4"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </span>
        <span class="nav-label">{{ item.label }}</span>
      </a>
    </div>
  </div>

  <div class="sidebar-bottom">
    <div class="user-card" *ngIf="user; else signInBlock">
      <div class="avatar">{{ user.name.charAt(0) | uppercase }}</div>
      <div class="user-info">
        <div class="name">{{ user.name }}</div>
        <div class="email">{{ user.email }}</div>
      </div>
      <button class="ghost-btn" type="button" (click)="logout()">Logout</button>
    </div>

    <ng-template #signInBlock>
      <button class="ghost-link" type="button" (click)="goToLogin()">
        <span class="nav-icon" aria-hidden="true">
          <svg viewBox="0 0 24 24" focusable="false">
            <path d="M4 4h9a3 3 0 0 1 3 3v2" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
            <path d="M4 20h9a3 3 0 0 0 3-3v-2" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
            <path d="M12 12h8" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
            <path d="M17 9l3 3-3 3" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </span>
        <span class="nav-label">Sign in</span>
      </button>
    </ng-template>
  </div>
</nav>
